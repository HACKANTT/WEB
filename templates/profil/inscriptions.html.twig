{% extends 'b_head.html.twig' %}

{% block title %}S'inscrire
{% endblock %}

{% block body %}
	<div style="background-color:#076ae0;height:64px;height: 75px;margin-bottom: 50px;position: fixed;width:100%;"></div>

	<!-- Start: 1 Row 2 Columns -->
	<div class="container-lg">
		<div class="row gx-md-0">
			<div class="col-md-4 col-lg-3 col-xl-3" style="margin-top: 100px;">
				<div id="sidebar-main" class="sidebar sidebar-default sidebar-separate">
					<div class="sidebar-category sidebar-default">
						<div class="category-title">
							<span>{{ app.user.nom }}
								{{ app.user.prenom }}</span>
						</div>
						<div class="category-content">
							<ul class="nav flex-column" id="profil-nav">
								<li class="nav-item">
									<a class="nav-link" href="{{path('app_profil')}}">
										<svg xmlns="http://www.w3.org/2000/svg" viewbox="-32 0 512 512" width="1em" height="1em" fill="currentColor" class="fs-4" aria-hidden="true"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M224 256c70.7 0 128-57.31 128-128s-57.3-128-128-128C153.3 0 96 57.31 96 128S153.3 256 224 256zM274.7 304H173.3C77.61 304 0 381.6 0 477.3c0 19.14 15.52 34.67 34.66 34.67h378.7C432.5 512 448 496.5 448 477.3C448 381.6 370.4 304 274.7 304z"></path>
										</svg>
										Mon profil</a>
								</li>
								<li class="nav-item">
									<a class="nav-link active" href="{{path('app_inscriptions')}}">
										<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" width="1em" height="1em" fill="currentColor" class="fs-4" aria-hidden="true"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M152.1 38.16C161.9 47.03 162.7 62.2 153.8 72.06L81.84 152.1C77.43 156.9 71.21 159.8 64.63 159.1C58.05 160.2 51.69 157.6 47.03 152.1L7.029 112.1C-2.343 103.6-2.343 88.4 7.029 79.03C16.4 69.66 31.6 69.66 40.97 79.03L63.08 101.1L118.2 39.94C127 30.09 142.2 29.29 152.1 38.16V38.16zM152.1 198.2C161.9 207 162.7 222.2 153.8 232.1L81.84 312.1C77.43 316.9 71.21 319.8 64.63 319.1C58.05 320.2 51.69 317.6 47.03 312.1L7.029 272.1C-2.343 263.6-2.343 248.4 7.029 239C16.4 229.7 31.6 229.7 40.97 239L63.08 261.1L118.2 199.9C127 190.1 142.2 189.3 152.1 198.2V198.2zM224 96C224 78.33 238.3 64 256 64H480C497.7 64 512 78.33 512 96C512 113.7 497.7 128 480 128H256C238.3 128 224 113.7 224 96V96zM224 256C224 238.3 238.3 224 256 224H480C497.7 224 512 238.3 512 256C512 273.7 497.7 288 480 288H256C238.3 288 224 273.7 224 256zM160 416C160 398.3 174.3 384 192 384H480C497.7 384 512 398.3 512 416C512 433.7 497.7 448 480 448H192C174.3 448 160 433.7 160 416zM0 416C0 389.5 21.49 368 48 368C74.51 368 96 389.5 96 416C96 442.5 74.51 464 48 464C21.49 464 0 442.5 0 416z"></path>
										</svg>&nbsp;Mes inscriptions</a>
								</li>
								<li class="nav-item">
									<a class="nav-link" href="{{path('app_favoris')}}">
										<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" width="1em" height="1em" fill="currentColor" class="fs-4" aria-hidden="true"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M256.3-.0068C261.9-.0507 267.3 1.386 272.1 4.066L476.5 90.53C487.7 95.27 495.2 105.1 495.9 118.1C501.6 213.6 466.7 421.9 272.5 507.7C267.6 510.5 261.1 512.1 256.3 512C250.5 512.1 244.9 510.5 239.1 507.7C45.8 421.9 10.95 213.6 16.57 118.1C17.28 105.1 24.83 95.27 36.04 90.53L240.4 4.066C245.2 1.386 250.7-.0507 256.3-.0068H256.3zM266.1 363.4L364.2 263.6C392.2 234.7 390.5 186.6 358.1 159.5C331.8 135.8 291.5 140.2 266.1 166.5L256.4 176.1L245.9 166.5C221.4 140.2 180.2 135.8 153 159.5C121.5 186.6 119.8 234.7 147.8 263.6L244.2 363.4C251.2 369.5 260.8 369.5 266.1 363.4V363.4z"></path>
										</svg>
										Hackathons favoris</a>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<div class="col-md-8 col-lg-9 col-xl-9" style="
																																													    margin-top: 100px;
																																													">
				<div class="container">
					<ol class="breadcrumb">
						<li class="breadcrumb-item">
							<a href="{{path('app_home')}}#page-top">
								<span>Home</span>
							</a>
						</li>
						<li class="breadcrumb-item">
							<a>
								<span>Profil</span>
							</a>
						</li>
						<li class="breadcrumb-item active" aria-current="page">
							<span>Mes inscriptions</span>
						</li>
					</ol>
					<div class="row justify-content-center">
						<div class="col-12 col-sm-8 col-lg-6">
							<div class="text-center section_heading wow fadeInUp" data-wow-delay="0.2s" style="visibility: visible;animation-delay: 0.2s;animation-name: fadeInUp;">
								<h4 class="text-nowrap d-xl-flex justify-content-xl-center" style="margin-top: 10px;">Vous êtes inscrits à ces
									{{hackathons|length}}
									hackathons</h4>
								<div class="line"></div>
							</div>
						</div>
					</div>
					{# on affiche les flashs danger et success #}
					{% for message in app.flashes('danger') %}
						<div class="alert alert-danger">
							{{ message }}
						</div>
					{% endfor %}
					{% for message in app.flashes('success') %}
						<div class="alert alert-success">
							{{ message }}
						</div>
					{% endfor %}
					<div class="row">
						{% for hackathon in hackathons %}
							<div class="col-12 col-sm-6 col-lg-3">
								<div class="single_advisor_profile wow fadeInUp" data-wow-delay="0.2s" style="visibility: visible;animation-delay: 0.2s;animation-name: fadeInUp;">
									<div class="advisor_thumb"><img class="rounded" src="{{hackathon.idH.image}}" alt="" height="300px">
										<div id="{{hackathon.idH.id}}"class="social-info">
											{% if hackathon.idH in favoris %}
												<a id="estfavori" class="coeurfavoris" href="{{path('app_api_fav_hackathon', {id: hackathon.idH.id})}}" style="margin-top: 10px;">
													<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" width="1em" height="1em" fill="currentColor" class="fs-5"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84.02L256 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 .0003 232.4 .0003 190.9L0 190.9z"></path>
													</svg>
												</a>
											{% else %}
												<a id="nonfavori" class="coeurfavoris" href="{{path('app_api_fav_hackathon', {id: hackathon.idH.id})}}">
													<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" width="1em" height="1em" fill="currentColor" class="fs-5"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z"></path>
													</svg>
												</a>
											{% endif %}
											<a class="desinscription" href="{{path('app_api_desinscription_hackathon', {id: hackathon.idH.id})}}">
												<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" width="1em" height="1em" fill="currentColor" class="fs-5"><!--! Font Awesome Pro 6.3.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M377.9 105.9L500.7 228.7c7.2 7.2 11.3 17.1 11.3 27.3s-4.1 20.1-11.3 27.3L377.9 406.1c-6.4 6.4-15 9.9-24 9.9c-18.7 0-33.9-15.2-33.9-33.9l0-62.1-128 0c-17.7 0-32-14.3-32-32l0-64c0-17.7 14.3-32 32-32l128 0 0-62.1c0-18.7 15.2-33.9 33.9-33.9c9 0 17.6 3.6 24 9.9zM160 96L96 96c-17.7 0-32 14.3-32 32l0 256c0 17.7 14.3 32 32 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-64 0c-53 0-96-43-96-96L0 128C0 75 43 32 96 32l64 0c17.7 0 32 14.3 32 32s-14.3 32-32 32z"/>
												</svg>
											</a>
										</div>
									</div>
									<div class="single_advisor_details_info">
										<h6>{{hackathon.idH.theme}}</h6>
										<p class="designation">Du
											{{hackathon.idH.dateDebut|format_datetime('short', 'none', locale='fr')}}
											au
											{{hackathon.idH.dateFin|format_datetime('short', 'none', locale='fr')}}</p>
									</div>
								</div>
							</div>
						{% endfor %}
					</div>
				</div>
			</div>
		</div>
	</div>
	<script>
		/* lesLiens contient la liste des éléments <a> correspond au lien avec le 
pouce, le nombre de like et le j'aime */
var favoris = document.getElementsByClassName('coeurfavoris')
var desinscription = document.getElementsByClassName('desinscription')

/* On parcourt la liste des liens et on ajoute un écouteur d'événement
sur le clic de la souris */

for (let i = 0; i < favoris.length; i++) {
favoris[i].addEventListener('click', majFavoris)
}

function majFavoris(event) {
    event.preventDefault()
    let xhr = new XMLHttpRequest();
    let baliseA = event.currentTarget; // accès à la balise <div class="social-info">
    let url = baliseA.getAttribute('href');
    console.log(baliseA);
    console.log(url);
    xhr.open("GET", url);
    xhr.responseType = "json";
    xhr.send();

    xhr.onload = function () {
        if (xhr.status != 200) {
            alert("Erreur " + xhr.status + " : " + xhr.statusText);
        } else { // on regarde si la réponse est à {"success":"0"}, on masque le a avec l'id "nonfavori"
            if (xhr.response.success == "0") {
				//on masque la balise A
				baliseA.classList.add('d-none');
				//on ajoute une nouvelle div a dans la classe parente social-info
				let div = document.createElement('a');
				div.setAttribute('id', 'nonfavori');
				div.setAttribute('class', 'coeurfavoris');
				div.setAttribute('href', '/fav/hackathon/'+ baliseA.parentNode.getAttribute('id'));
				div.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" width="1em" height="1em" fill="currentColor" class="fs-5"><!--! Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc. --><path d="M244 84L255.1 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 0 232.4 0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84C243.1 84 244 84.01 244 84L244 84zM255.1 163.9L210.1 117.1C188.4 96.28 157.6 86.4 127.3 91.44C81.55 99.07 48 138.7 48 185.1V190.9C48 219.1 59.71 246.1 80.34 265.3L256 429.3L431.7 265.3C452.3 246.1 464 219.1 464 190.9V185.1C464 138.7 430.4 99.07 384.7 91.44C354.4 86.4 323.6 96.28 301.9 117.1L255.1 163.9z"></path></svg></a>';
				baliseA.parentNode.appendChild(div);
				//on ajoute un écouteur d'événement sur le clic de la souris
				div.addEventListener('click', majFavoris);
            } else {	
				//on masque la balise A
				baliseA.classList.add('d-none');
				//on ajoute une nouvelle div a dans la classe parente social-info
				let div = document.createElement('a');
				div.setAttribute('id', 'estfavori');
				div.setAttribute('class', 'coeurfavoris');
				div.setAttribute('href', '/fav/hackathon/'+ baliseA.parentNode.getAttribute('id'));
				div.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 512 512" width="1em" height="1em" fill="currentColor" class="fs-5"><path d="M0 190.9V185.1C0 115.2 50.52 55.58 119.4 44.1C164.1 36.51 211.4 51.37 244 84.02L256 96L267.1 84.02C300.6 51.37 347 36.51 392.6 44.1C461.5 55.58 512 115.2 512 185.1V190.9C512 232.4 494.8 272.1 464.4 300.4L283.7 469.1C276.2 476.1 266.3 480 256 480C245.7 480 235.8 476.1 228.3 469.1L47.59 300.4C17.23 272.1 .0003 232.4 .0003 190.9L0 190.9z"></path></svg></a>';
				baliseA.parentNode.appendChild(div);
				//on ajoute un écouteur d'événement sur le clic de la souris
				div.addEventListener('click', majFavoris);
				}
            };
        };
    };
	</script>
{% endblock %}
